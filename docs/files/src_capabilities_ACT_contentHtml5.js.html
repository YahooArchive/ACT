<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/capabilities/ACT_contentHtml5.js - ACT.js</title>
    <link rel="stylesheet" href="https://s.yimg.com/zz/combo?yui-s:3.14.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="https://s.yimg.com/rz/l/favicon.ico">
    <script src="https://s.yimg.com/zz/combo?yui-s:3.14.1/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="https://s.yimg.com/cv/ae/global/ACTJS/logo/ACT.js.logo.png" title="ACT.js" width="150"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                            <li><a href="#api-demos">Demo and Examples</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ACT.html">ACT</a></li>
                                <li><a href="../classes/ActionsQueue.html">ActionsQueue</a></li>
                                <li><a href="../classes/Base.html">Base</a></li>
                                <li><a href="../classes/Capability.html">Capability</a></li>
                                <li><a href="../classes/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../classes/Class.html">Class</a></li>
                                <li><a href="../classes/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../classes/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../classes/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../classes/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../classes/ContentImage.html">ContentImage</a></li>
                                <li><a href="../classes/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../classes/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../classes/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../classes/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../classes/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../classes/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../classes/Cookie.html">Cookie</a></li>
                                <li><a href="../classes/CustomData.html">CustomData</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/Dom.html">Dom</a></li>
                                <li><a href="../classes/DwellTime.html">DwellTime</a></li>
                                <li><a href="../classes/Enabler.html">Enabler</a></li>
                                <li><a href="../classes/EnablerADTECH.html">EnablerADTECH</a></li>
                                <li><a href="../classes/EnablerConfig.html">EnablerConfig</a></li>
                                <li><a href="../classes/Environment.html">Environment</a></li>
                                <li><a href="../classes/Event.html">Event</a></li>
                                <li><a href="../classes/Flash.html">Flash</a></li>
                                <li><a href="../classes/IO.html">IO</a></li>
                                <li><a href="../classes/Json.html">Json</a></li>
                                <li><a href="../classes/Lang.html">Lang</a></li>
                                <li><a href="../classes/LayersList.html">LayersList</a></li>
                                <li><a href="../classes/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../classes/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../classes/Screen.html">Screen</a></li>
                                <li><a href="../classes/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../classes/StandardAd.html">StandardAd</a></li>
                                <li><a href="../classes/Tracking.html">Tracking</a></li>
                                <li><a href="../classes/UA.html">UA</a></li>
                                <li><a href="../classes/Util.html">Util</a></li>
                                <li><a href="../classes/VideoEvents.html">VideoEvents</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ACT.html">ACT</a></li>
                                <li><a href="../modules/actionsQueue.html">actionsQueue</a></li>
                                <li><a href="../modules/Base.html">Base</a></li>
                                <li><a href="../modules/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../modules/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../modules/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../modules/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../modules/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../modules/ContentImage.html">ContentImage</a></li>
                                <li><a href="../modules/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../modules/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../modules/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../modules/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../modules/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../modules/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../modules/Cookie.html">Cookie</a></li>
                                <li><a href="../modules/DwellTime.html">DwellTime</a></li>
                                <li><a href="../modules/Enabler.html">Enabler</a></li>
                                <li><a href="../modules/EnablerADTECH.html">EnablerADTECH</a></li>
                                <li><a href="../modules/environment.html">environment</a></li>
                                <li><a href="../modules/IO.html">IO</a></li>
                                <li><a href="../modules/LayersList.html">LayersList</a></li>
                                <li><a href="../modules/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../modules/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../modules/Screen.html">Screen</a></li>
                                <li><a href="../modules/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../modules/StandardAd.html">StandardAd</a></li>
                                <li><a href="../modules/Tracking.html">Tracking</a></li>
                            </ul>
                
                            <ul id="api-demos" class="apis demos">
                                <li><a href="../demo/ACT_Demo_300x250.html">300x250</a></li>
                                <li><a href="../demo/ACT_Demo_300x250_tracking.html">300x250_tracking</a></li>
                                <li><a href="../demo/ACT_Demo_TrackingExample.html">TrackingExample</a></li>
                                <li><a href="../demo/ACT_Demo_animation.html">animation</a></li>
                                <li><a href="../demo/ACT_Demo_billboard.html">billboard</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-enabler.html">billboard-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-expandable-enabler.html">billboard-expandable-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video.html">billboard_html_video</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video_rtl.html">billboard_html_video_rtl</a></li>
                                <li><a href="../demo/ACT_Demo_carousel.html">carousel</a></li>
                                <li><a href="../demo/ACT_Demo_dwelltime.html">dwelltime</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_expand.html">enabler_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_fullscreen_expand.html">enabler_fullscreen_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_target.html">enabler_target</a></li>
                                <li><a href="../demo/ACT_Demo_floating.html">floating</a></li>
                                <li><a href="../demo/ACT_Demo_force_env.html">force_env</a></li>
                                <li><a href="../demo/ACT_Demo_html5_enabler.html">html5_enabler</a></li>
                                <li><a href="../demo/ACT_Demo_html5_standard.html">html5_standard</a></li>
                                <li><a href="../demo/ACT_Demo_icons.html">icons</a></li>
                                <li><a href="../demo/ACT_Demo_input_data.html">input_data</a></li>
                                <li><a href="../demo/ACT_Demo_login_html.html">login_html</a></li>
                                <li><a href="../demo/ACT_Demo_overwrite_env.html">overwrite_env</a></li>
                                <li><a href="../demo/ACT_Demo_splash_ad.html">splash_ad</a></li>
                                <li><a href="../demo/ACT_Demo_tablet_expandable.html">tablet_expandable</a></li>
                                <li><a href="../demo/ACT_Demo_video_event.html">video_event</a></li>
                                <li><a href="../demo/ACT_Demo_video_html.html">video_html</a></li>
                            </ul>
                
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/capabilities/ACT_contentHtml5.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * Copyright 2016, Yahoo Inc.
 * Copyrights licensed under the New BSD License.
 * See the accompanying LICENSE file for terms.
 */

/* global ACT */
/* eslint no-useless-concat: 0 */
/**
 * The &#x27;ContentHtml5&#x27; is a capability made to generate a &#x27;DIV&#x27; or an &#x27;IFRAME&#x27; tag use for htlm5 assets.
 *
 *
 * @module ContentHtml5
 * @main ContentHtml5
 * @class ContentHtml5
 * @requires Dom, lang, Event, Class, Capability
 * @global
 */
ACT.define(&#x27;ContentHtml5&#x27;, [/*@&lt;*/&#x27;Debug&#x27;, /*&gt;@*/ &#x27;Dom&#x27;, &#x27;Lang&#x27;, &#x27;Event&#x27;, &#x27;Class&#x27;, &#x27;Capability&#x27;, &#x27;Json&#x27;], function (ACT) {
    &#x27;use strict&#x27;;

    /* Shorthand */
    var Dom = ACT.Dom;
    var Lang = ACT.Lang;
    var Class = ACT.Class;
    var Event = ACT.Event;
    var JSON = ACT.Json;
    var Capability = ACT.Capability;

    /* Event name */
    var EVENT_HTML5_BROADCAST = &#x27;html5:broadcast&#x27;;
    var EVENT_HTML5_CHANGE_STYLES = &#x27;html5:changeStyles&#x27;;
    var EVENT_GLOBAL_ACTION_COMPLETE = &#x27;complete:action&#x27;;
    var EVENT_GLOBAL_SCREEN_STATUS = &#x27;screen:status&#x27;;
    var EVENT_GLOBAL_STOP_CONTENT = &#x27;STOP_CONTENT&#x27;;
    var EVENT_ADD_ACTIONS = &#x27;add:actions&#x27;;
    var EVENT_ENABLER_ACTIONS = &#x27;Enabler:actions&#x27;;
    var ENABLER_DEFAULT_PATH = &#x27;https://s.yimg.com/cv/actjs/1.0.15/min/&#x27;;

    var contentActions = [{
        type: &#x27;html5Broadcast&#x27;,
        argument: {
            to: {
                name: &#x27;to&#x27;,
                test: function (value) {
                    return Lang.isString(value);
                }
            },
            name: {
                name: &#x27;name&#x27;,
                test: function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_HTML5_BROADCAST, {
                containerId: args.to,
                name: args.name
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;changeHtml5FrameStyles&#x27;,
        argument: {
            to: {
                name: &#x27;to&#x27;,
                test: function (value) {
                    return Lang.isString(value);
                }
            },
            css: {
                name: &#x27;css&#x27;,
                test: function (value) {
                    return Lang.isObject(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_HTML5_CHANGE_STYLES, {
                containerId: args.to,
                css: args.css,
                done: function () {
                    Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
                }
            });
        }
    }];

    /**
     * Post Message Handler
     */
    var HANDLER_COLLECTION = [];

    /*@&lt;*/
    var Debug = ACT.Debug;
    Debug.log(&#x27;[ ACT_contentHtml5.js ] ContentHtml5 Loaded&#x27;);
    /*&gt;@*/

    Event.on(&#x27;message&#x27;, function (event) {
        var index;
        for (index = 0; index &lt; HANDLER_COLLECTION.length; index ++) {
            HANDLER_COLLECTION[index].eventHandler(event);
        }
    }, window);

    /**
     * @constructor
     */
    function ContentHtml5(config) {
        this.init(config);
        // ContentHtml5.superclass.constructor.apply(this, arguments);
    }

    ContentHtml5.ATTRS = {
        /**
         * @attribute NAME
         * @type String
         */
        NAME: &#x27;ContentHtml5&#x27;,

        /**
         * @attribute configObject
         * @type Object
         */
        configObject: {},

        /**
         * @attribute node
         * @type HTMLElement
         */
        node: null,

        /**
         * @attribute enablerActions
         */
        enablerActions: {},

        /**
         * List of keywords related labes for tracking
         * For e.g &#x27;video1:start&#x27; : &#x27;billboard_view_video1_start&#x27;
         * @attribute trackingLabels
         */
         trackingLabels: {},

         /**
         * Set to true if you want to track things that are not defined in tracking labels.
         * set to False by default.
         */
         trackMisc: false
    };

    /* Private methods */


    /**
     * Generate the node div tag with params
     *
     * @method renderDiv
     * @private
     * @param {Object} config
     * @return {HTMLElement}
     */
    function renderDiv(config) {
        var div = document.createElement(&#x27;div&#x27;);
        var script = document.createElement(&#x27;script&#x27;);

        div.setAttribute(&#x27;id&#x27;, config.id);
        script.type = &#x27;text/javascript&#x27;;
        script.src = config.html5Config.src;
        div.appendChild(script);

        return div;
    }

    /**
     * Generate the node iframe tag with params
     *
     * @method renderIframe
     * @private
     * @param {Object} config
     * @return {HTMLElement}
     */
    function renderIframe(config) {
        var load;
        var name;
        var iframe = document.createElement(&#x27;iframe&#x27;);

        iframe.setAttribute(&#x27;id&#x27;, config.id);
        iframe.setAttribute(&#x27;marginwidth&#x27;, 0);
        iframe.setAttribute(&#x27;marginheight&#x27;, 0);
        iframe.setAttribute(&#x27;hspace&#x27;, 0);
        iframe.setAttribute(&#x27;vspace&#x27;, 0);
        iframe.setAttribute(&#x27;frameborder&#x27;, 0);
        iframe.setAttribute(&#x27;scrolling&#x27;, &#x27;no&#x27;);

        if (config.html5Config.iframeUrlPath) {
            name = Lang.isObject(config.html5Config.iframevars) ? config.html5Config.iframevars : null;
            iframe.setAttribute(&#x27;name&#x27;, encodeURI(JSON.stringify(name)));
            iframe.setAttribute(&#x27;src&#x27;, config.html5Config.iframeUrlPath);
            return iframe;
        }

        load = function () {
            iframe.onload = null;
            setTimeout(function () {
                var iframeVars = config.html5Config.iframevars || {};
                var iframeContent = (iframe.contentWindow || iframe.contentDocument);
                var iframeDocument = (iframeContent.document) ? iframeContent.document : iframeContent;
                iframeVars.frameId = config.id;

                /* istanbul ignore else */
                if (config.trackingLabels) {
                    iframeVars.trackingLabels = config.trackingLabels;
                }

                iframeDocument.open();

                if (config.html5Config.enabler) {
                    iframeDocument.write(&#x27;&lt;scr&#x27; + &#x27;ipt type=&quot;text/javascript&quot; src=&quot;&#x27; +
                        ((config.html5Config.enablerPath) ? config.html5Config.enablerPath : ENABLER_DEFAULT_PATH) + &#x27;ACT_Enabler.js&quot;&gt;&lt;/scr&#x27; + &#x27;ipt&gt;&#x27;);
                    iframeDocument.write(&#x27;&lt;scr&#x27; + &#x27;ipt type=&quot;text/javascript&quot;&gt; Enabler.setConfig(&#x27; + JSON.stringify(iframeVars) + &#x27;); &lt;/scr&#x27; + &#x27;ipt&gt;&#x27;);
                } else {
                    iframeDocument.write(&#x27;&lt;scr&#x27; + &#x27;ipt type=&quot;text/javascript&quot;&gt; var ACT = &#x27; + JSON.stringify(iframeVars) + &#x27;; &lt;/scr&#x27; + &#x27;ipt&gt;&#x27;);
                }

                iframeDocument.write(&#x27;&lt;body&gt;&#x27; + config.html5Config.src + &#x27;&lt;/body&gt;&#x27;);
                iframeDocument.close();
            }, 1);
        };

        iframe.onload = load;
        return iframe;
    }

    /**
     * @method genarateEventActions
     * @private
     * @param {Object} eventActions
     */
    function genarateEventActions(eventActions, callback) {
        var name;
        var action;

        /* istanbul ignore next */
        if (typeof eventActions !== &#x27;object&#x27;) {
            return;
        }

        for (name in eventActions) {
            if (eventActions.hasOwnProperty(name)) {
                action = eventActions[name];
                callback(action);
            }
        }
    }

    // TODO: See about moving this to Class
    /**
     * @method subscribeActionToEvent
     * @private
     * @param {Object} action
     */
    function subscribeActionToEvent(action) {
        Event.on(action.eventType, function () {
            Event.fire(EVENT_ADD_ACTIONS, action.actions);
        });
    }

    /* Public methods */

    Lang.extend(ContentHtml5, [Capability, Class], {
        /**
         * Function auto initiated when the class is instantiated
         * @method initializer
         * @public
         * @param {Object} config
         */
        initializer: function (config) {
            /* Set ID */
            this.set(&#x27;nodeId&#x27;, config.id);

            /* Store the  configObject */
            this.set(&#x27;configObject&#x27;, config);

            /* Subscribe listeners */
            this.initializeListeners();

            /* prepare enabler actions */
            this.initializeEnablerActions(config);

            /* Register actions */
            Event.fire(&#x27;register:Actions&#x27;, contentActions);

            if (config.hasOwnProperty(&#x27;trackingLabels&#x27;)) {
                this.set(&#x27;trackingLabels&#x27;, config.trackingLabels);
            }

            if (config.hasOwnProperty(&#x27;trackMisc&#x27;)) {
                this.set(&#x27;trackMisc&#x27;, config.trackMisc);
            }

            /* Register postmesage handler */
            HANDLER_COLLECTION.push(this);
        },

        /**
         * Function to initialize event listeners for this instance
         *
         * @method initializeListeners
         */
        initializeListeners: function () {
            var root = this;

            root.addEventListeners(
                Event.on(EVENT_HTML5_BROADCAST, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;nodeId&#x27;) === eventData.containerId) {
                        root.broadcastToHtml5(eventData.name);
                    }
                }),
                Event.on(EVENT_HTML5_CHANGE_STYLES, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;nodeId&#x27;) === eventData.containerId) {
                        root.changeStyles(eventData.css, eventData.done);
                    }
                }),
                Event.on(EVENT_GLOBAL_SCREEN_STATUS, function (status) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;configObject&#x27;) &amp;&amp; root.get(&#x27;configObject&#x27;).resize) {
                        root.resize(status, root.get(&#x27;configObject&#x27;));
                    }
                }),
                // TODO: See if this event can be generalized in Class.
                Event.on(EVENT_GLOBAL_STOP_CONTENT, function () {
                    root.broadcastToHtml5(&#x27;stop&#x27;);
                })
            );
        },

        /**
         * @method wrapActionsList
         */
        wrapActionsList: function (actionList) {
            return function () {
                Event.fire(EVENT_ADD_ACTIONS, actionList);
            };
        },

        /**
         * prepare actions definition for enablers actions
         * @method initializeEnablerActions
         */
        initializeEnablerActions: function (config) {
            var actions;
            var eventConfig;
            var index;
            var eventAction;
            var trigger;
            var actionList;
            if (!Lang.isObject(config.html5Config) || !config.html5Config.enabler) {
                return;
            }

            // applying default enbler actions
            actions = {
                // handle track event
                track: Lang.bind(this, null, this.fireEnablerTracking)
            };

            // go through list of eventConfig to setup what actions should be done when receive an event from Enabler child
            eventConfig = config.eventConfig;
            if (Lang.isObject(eventConfig)) {
                for (index = 0; index &lt; eventConfig.length; index ++) {
                    eventAction = eventConfig[index];
                    if (Lang.isObject(eventAction) &amp;&amp; eventAction.hasOwnProperty(&#x27;eventType&#x27;) &amp;&amp; eventAction.hasOwnProperty(&#x27;actions&#x27;)) {
                        trigger = eventAction.eventType;
                        actionList = eventAction.actions;
                        actions[trigger] = this.wrapActionsList(actionList);
                    }
                }
            }
            this.set(&#x27;enablerActions&#x27;, actions);
        },

        /**
         * Handle tracking event sent from Enabler
         * We will check if eventId is defined in trackingLabels list, then fire tracking event with related label
         * @method fireEnablerTracking
         * @param {Object} data Data sent by Enabler event action
         */
        fireEnablerTracking: function (data) {
            var trackingLabels = this.get(&#x27;trackingLabels&#x27;);
            var trackMisc = this.get(&#x27;trackMisc&#x27;);
            if (trackingLabels.hasOwnProperty(data.id)) {
                Event.fire(EVENT_ADD_ACTIONS, {
                    type: &#x27;track&#x27;,
                    label: trackingLabels[data.id]
                });
            } else if (trackMisc === true) {
                /* For the case where we want to track things that are not defined in the trackingLabels.
                This is used by ID&#x27;s that defined some tracking labels but not all of them, and would like to fire
                misc tracks.
                */
                Event.fire(EVENT_ADD_ACTIONS, {
                    type: &#x27;track&#x27;,
                    label: data.id
                });
            }
        },

        /**
         * Broadcast to the html5 script
         * @method startHtml5
         */
        broadcastToHtml5: function (name) {
            var iframe = this.get(&#x27;node&#x27;);
            var config = this.get(&#x27;configObject&#x27;);
            var iframeContent;

            if (config.html5Config.hasOwnProperty(&#x27;iframe&#x27;) &amp;&amp; config.html5Config.iframe &amp;&amp; iframe) {
                iframeContent = (iframe.contentWindow || iframe.contentDocument);
                iframeContent.postMessage({ eventName: &#x27;html5:message&#x27;, message: name }, &#x27;*&#x27;);
            } else {
                Event.fire(&#x27;html5:message&#x27;, { message: name });
            }
        },

        /**
         * Function called when the instance is destroyed
         * @method destructor
         * @public
         */
        destructor: function () {
            var node = this.get(&#x27;node&#x27;);

            /* Remove the node from the DOM */
            if (Dom.isDomElement(node) &amp;&amp; node.parentNode) {
                node.parentNode.removeChild(node);
            }

            /* Unegister postmesage handler */
            HANDLER_COLLECTION.splice(HANDLER_COLLECTION.indexOf(this), 1);
        },

        /**
         * Render the node from given config object, environment and orientation state
         *
         * @method renderContent
         * @param {Object} configObject
         * @param {String} env
         * @param {String} orientation
         * @return {HTMLElement} node
         */
        renderContent: function (configObject) {
            var node = (configObject.html5Config.iframe) ? renderIframe(configObject) : renderDiv(configObject);
            genarateEventActions(configObject.eventActions, subscribeActionToEvent);
            node = this.applyNodeConfig(node, configObject);
            // return node
            return node;
        },

        /**
         * Function generating the node &#x27;IFRAME&#x27; or &#x27;DIV&#x27;
         * @method getContent
         * @public
         * @param {String} env Environment for rendering content such as html/flash/backup
         * @param {String} orientation Orientation of current device such as landscape and portraits for mobile
         * @return {Object}
         */
        getContent: function (env, orientation) {
            var root = this;
            var node = root.renderContent(this.get(&#x27;configObject&#x27;), env, orientation);
            this.set(&#x27;node&#x27;, node);

            // Listen to event send back by enabler
            if (this.get(&#x27;configObject&#x27;).html5Config.enabler === true) {
                this.addEventListeners(
                    Event.on(EVENT_ENABLER_ACTIONS, ACT.Lang.bind(root, null, root.enablerActionHandler))
                );
            }

            return {
                node: node
            };
        },

        /**
         * Function call by the iframe
         *
         * @method eventHandler
         * @public
         */
        eventHandler: function (event) {
            var iframe = this.get(&#x27;node&#x27;);
            var config = this.get(&#x27;configObject&#x27;);
            var data;
            var iframeContent;

            if (config.html5Config.hasOwnProperty(&#x27;iframe&#x27;) &amp;&amp; config.html5Config.iframe &amp;&amp; iframe) {
                iframeContent = (iframe.contentWindow || iframe.contentDocument);
                if (event.source === iframeContent) {
                    data = event.data;
                    if (data.hasOwnProperty(&#x27;type&#x27;)) {
                        Event.fire(data.type);
                    } else if (data.hasOwnProperty(&#x27;actions&#x27;)) {
                        Event.fire(EVENT_ADD_ACTIONS, data.actions);
                    } else if (data.hasOwnProperty(&#x27;EnablerData&#x27;)) {
                        // need to add container id here to mark this event from child iframe
                        data.EnablerData.frameId = config.id;
                        Event.fire(EVENT_ENABLER_ACTIONS, data.EnablerData);
                    }
                }
            }
        },

        /**
         * Handle event data send by Enabler
         *
         * @method enablerActionHandler
         * @param {Object} data
         */
        enablerActionHandler: function (data) {
            var actions;
            /*@&lt;*/
            Debug.log(&#x27;[ ACT_contentHtml5.js ] enablerActionHandler: receive event&#x27;, data);
            /*&gt;@*/

            /* Need to make sure the event came from the child iframe. */
            if (data.frameId !== this.get(&#x27;configObject&#x27;).id) {
                /*@&lt;*/
                Debug.log(&#x27;[ ACT_contentHtml5.js ] enablerActionHandler: event from different iframe, ignore it. data.frameId is:&#x27;,
                    data.frameId, &#x27;Config Obj ID is:&#x27;, this.get(&#x27;configObject&#x27;).id, &#x27;full data set is:&#x27;, data);
                /*&gt;@*/
                return false;
            }

            actions = this.get(&#x27;enablerActions&#x27;);

            if (data.actionName === &#x27;track&#x27;) {
                actions.track(data);
            } else if (actions.hasOwnProperty(data.id)) {
                actions[data.id](data);
            }

            return true;
        },

        /**
         * @method changeStyles
         * @param {Object} styles New styles to be applied
         */
        changeStyles: function (styles, done) {
            var node = this.get(&#x27;node&#x27;);

            Dom.applyStyles(node, styles);

            if (Lang.isFunction(done)) {
                done();
            }
        }
    });

    return ContentHtml5;
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
