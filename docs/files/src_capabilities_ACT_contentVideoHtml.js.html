<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/capabilities/ACT_contentVideoHtml.js - ACT.js</title>
    <link rel="stylesheet" href="https://s.yimg.com/zz/combo?yui-s:3.14.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="https://s.yimg.com/rz/l/favicon.ico">
    <script src="https://s.yimg.com/zz/combo?yui-s:3.14.1/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="https://s.yimg.com/cv/ae/global/ACTJS/logo/ACT.js.logo.png" title="ACT.js" width="150"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.1.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                            <li><a href="#api-demos">Demo and Examples</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ACT.html">ACT</a></li>
                                <li><a href="../classes/ActionsQueue.html">ActionsQueue</a></li>
                                <li><a href="../classes/Base.html">Base</a></li>
                                <li><a href="../classes/Capability.html">Capability</a></li>
                                <li><a href="../classes/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../classes/Class.html">Class</a></li>
                                <li><a href="../classes/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../classes/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../classes/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../classes/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../classes/ContentImage.html">ContentImage</a></li>
                                <li><a href="../classes/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../classes/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../classes/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../classes/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../classes/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../classes/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../classes/Cookie.html">Cookie</a></li>
                                <li><a href="../classes/CustomData.html">CustomData</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/Dom.html">Dom</a></li>
                                <li><a href="../classes/DwellTime.html">DwellTime</a></li>
                                <li><a href="../classes/Enabler.html">Enabler</a></li>
                                <li><a href="../classes/EnablerADTECH.html">EnablerADTECH</a></li>
                                <li><a href="../classes/EnablerConfig.html">EnablerConfig</a></li>
                                <li><a href="../classes/Environment.html">Environment</a></li>
                                <li><a href="../classes/Event.html">Event</a></li>
                                <li><a href="../classes/Flash.html">Flash</a></li>
                                <li><a href="../classes/IO.html">IO</a></li>
                                <li><a href="../classes/Json.html">Json</a></li>
                                <li><a href="../classes/Lang.html">Lang</a></li>
                                <li><a href="../classes/LayersList.html">LayersList</a></li>
                                <li><a href="../classes/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../classes/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../classes/Screen.html">Screen</a></li>
                                <li><a href="../classes/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../classes/StandardAd.html">StandardAd</a></li>
                                <li><a href="../classes/Tracking.html">Tracking</a></li>
                                <li><a href="../classes/UA.html">UA</a></li>
                                <li><a href="../classes/Util.html">Util</a></li>
                                <li><a href="../classes/VideoEvents.html">VideoEvents</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ACT.html">ACT</a></li>
                                <li><a href="../modules/actionsQueue.html">actionsQueue</a></li>
                                <li><a href="../modules/Base.html">Base</a></li>
                                <li><a href="../modules/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../modules/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../modules/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../modules/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../modules/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../modules/ContentImage.html">ContentImage</a></li>
                                <li><a href="../modules/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../modules/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../modules/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../modules/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../modules/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../modules/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../modules/Cookie.html">Cookie</a></li>
                                <li><a href="../modules/DwellTime.html">DwellTime</a></li>
                                <li><a href="../modules/Enabler.html">Enabler</a></li>
                                <li><a href="../modules/EnablerADTECH.html">EnablerADTECH</a></li>
                                <li><a href="../modules/environment.html">environment</a></li>
                                <li><a href="../modules/IO.html">IO</a></li>
                                <li><a href="../modules/LayersList.html">LayersList</a></li>
                                <li><a href="../modules/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../modules/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../modules/Screen.html">Screen</a></li>
                                <li><a href="../modules/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../modules/StandardAd.html">StandardAd</a></li>
                                <li><a href="../modules/Tracking.html">Tracking</a></li>
                            </ul>
                
                            <ul id="api-demos" class="apis demos">
                                <li><a href="../demo/ACT_Demo_300x250.html">300x250</a></li>
                                <li><a href="../demo/ACT_Demo_300x250_tracking.html">300x250_tracking</a></li>
                                <li><a href="../demo/ACT_Demo_TrackingExample.html">TrackingExample</a></li>
                                <li><a href="../demo/ACT_Demo_animation.html">animation</a></li>
                                <li><a href="../demo/ACT_Demo_billboard.html">billboard</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-enabler.html">billboard-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-expandable-enabler.html">billboard-expandable-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video.html">billboard_html_video</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video_rtl.html">billboard_html_video_rtl</a></li>
                                <li><a href="../demo/ACT_Demo_carousel.html">carousel</a></li>
                                <li><a href="../demo/ACT_Demo_dwelltime.html">dwelltime</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_expand.html">enabler_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_fullscreen_expand.html">enabler_fullscreen_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_target.html">enabler_target</a></li>
                                <li><a href="../demo/ACT_Demo_floating.html">floating</a></li>
                                <li><a href="../demo/ACT_Demo_force_env.html">force_env</a></li>
                                <li><a href="../demo/ACT_Demo_html5_enabler.html">html5_enabler</a></li>
                                <li><a href="../demo/ACT_Demo_html5_standard.html">html5_standard</a></li>
                                <li><a href="../demo/ACT_Demo_icons.html">icons</a></li>
                                <li><a href="../demo/ACT_Demo_input_data.html">input_data</a></li>
                                <li><a href="../demo/ACT_Demo_login_html.html">login_html</a></li>
                                <li><a href="../demo/ACT_Demo_overwrite_env.html">overwrite_env</a></li>
                                <li><a href="../demo/ACT_Demo_splash_ad.html">splash_ad</a></li>
                                <li><a href="../demo/ACT_Demo_tablet_expandable.html">tablet_expandable</a></li>
                                <li><a href="../demo/ACT_Demo_video_event.html">video_event</a></li>
                                <li><a href="../demo/ACT_Demo_video_html.html">video_html</a></li>
                            </ul>
                
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/capabilities/ACT_contentVideoHtml.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * Copyright 2016, Yahoo Inc.
 * Copyrights licensed under the New BSD License.
 * See the accompanying LICENSE file for terms.
 */

/* global ACT */
/**
 * Capability for rendering html5 video content.
 * Features:
      - rendering video tag with video source insides
      - Broadcasting video progress and states
 *
 * Example for config object:
 *
 *     {
 *         type: &#x27;content-video-html&#x27;,
 *          id: &#x27;video_id&#x27;,
 *          env: [&#x27;html&#x27;],
 *          css: {
 *              width: &#x27;400px&#x27;,
 *              height: &#x27;300px&#x27;
 *            },
 *          videoHtmlConfig:{
 *              controls: true | false, // enable/disable video native control - default is true - optional
 *              autoPlay: true | false, // enable/disable video auto play - default is false - optional
 *              videoMuted: true | false, // disable/enable video sound - default is false - optional
 *              posterImage: &#x27;link_to_poster_image&#x27;, // image to be show when video is loaded or before playing video - optional
 *              videoMP4: &#x27;link_to_mp4_video&#x27;,
 *              videoWebM: &#x27;link_to_webm_video&#x27;,
 *              videoOGG: &#x27;link_to_ogg_video&#x27;,
 *              videoOGV: &#x27;link_to_ogv_video&#x27;
 *          },
 *          eventConfig: [{
 *              eventType: &#x27;start&#x27; | &#x27;25percent&#x27; | &#x27;50percent&#x27; | &#x27;75percent&#x27; | &#x27;complete&#x27; | &#x27;pause&#x27; | &#x27;pausePlay&#x27;  | &#x27;soundon&#x27; | &#x27;soundoff&#x27; | &#x27;replay&#x27;,
 *              actions: [{
 *                  // ...
 *              }]
 *          }]
 *      }
 *
 *      // Available actions for the actions queue:
 *      {
 *          type: &#x27;video:start | video:stop | video:play | video:pause | video:soundOn | video:soundOff &#x27;,
 *          videoId: &#x27;video_id&#x27; // id of target video
 *      }
 *
 * @module ContentVideoHtml
 * @main ContentVideoHtml
 * @class ContentVideoHtml
 * @requires dom, lang, event, Class, Capability
 * @global
 */
ACT.define(&#x27;ContentVideoHtml&#x27;, [/*@&lt;*/&#x27;Debug&#x27;, /*&gt;@*/ &#x27;Dom&#x27;, &#x27;Lang&#x27;, &#x27;Event&#x27;, &#x27;Class&#x27;, &#x27;Capability&#x27;, &#x27;VideoEvents&#x27;], function (ACT) {
    &#x27;use strict&#x27;;

    /* Shorthand */
    var Dom = ACT.Dom;
    var Lang = ACT.Lang;
    var Event = ACT.Event;
    var Class = ACT.Class;
    var Capability = ACT.Capability;
    /*@&lt;*/
    var Debug = ACT.Debug;
    /*&gt;@*/

    /* Constants */
    var ACCEPTED_VIDEO_TYPE = [&#x27;WebM&#x27;, &#x27;MP4&#x27;, &#x27;OGG&#x27;, &#x27;OGV&#x27;];
    var VIDEO_FORMAT = {
        webm: &#x27;video/webm&#x27;,
        mp4: &#x27;video/mp4&#x27;,
        ogg: &#x27;video/ogg&#x27;,
        ogv: &#x27;video/ogg&#x27;
    };

    var EVENT_VIDEO_ACTION = &#x27;video:action&#x27;;

    var EVENT_VIDEO_STATE = &#x27;video:state&#x27;;
    var EVENT_VIDEO_START = &#x27;video:start&#x27;;
    var EVENT_VIDEO_STOP = &#x27;video:stop&#x27;;
    var EVENT_VIDEO_PLAY = &#x27;video:play&#x27;;
    var EVENT_VIDEO_SEEK = &#x27;video:seek&#x27;;
    var EVENT_VIDEO_PAUSE = &#x27;video:pause&#x27;;
    var EVENT_VIDEO_SOUNDON = &#x27;video:soundOn&#x27;;
    var EVENT_VIDEO_SOUNDOFF = &#x27;video:soundOff&#x27;;
    var EVENT_VIDEO_RESIZE = &#x27;video:resize&#x27;;
    var EVENT_VIDEO_FULLSCREEN = &#x27;video:fullscreen&#x27;;

    var EVENT_GLOBAL_SCREEN_STATUS = &#x27;screen:status&#x27;;
    var EVENT_GLOBAL_ACTION_COMPLETE = &#x27;complete:action&#x27;;
    var EVENT_GLOBAL_ACTION_REGISTER = &#x27;register:Actions&#x27;;
    var EVENT_GLOBAL_ACTION_ADD = &#x27;add:actions&#x27;;
    var EVENT_GLOBAL_CHECK_ACTION_CONDITION = &#x27;standardAd:checkActionCondition&#x27;;


    var DEFAULT_VIDEO_EVENT_ACTIONS = {
        clicked: &#x27;&#x27;,
        start: &#x27;&#x27;,
        replay: &#x27;&#x27;,
        pause: &#x27;&#x27;,
        resume: &#x27;&#x27;,
        soundon: &#x27;&#x27;,
        soundoff: &#x27;&#x27;,
        &#x27;25percent&#x27;: &#x27;&#x27;,
        &#x27;50percent&#x27;: &#x27;&#x27;,
        &#x27;75percent&#x27;: &#x27;&#x27;,
        complete: &#x27;&#x27;
    };

    /**
     * List of event for video
     */
    /* istanbul ignore next */
    var videoEvents = [{
        // start video from beginning
        type: &#x27;videoStart&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,

                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_START, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        // play video from where it left
        type: &#x27;videoPlay&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_PLAY, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        // seek video to a particular percentage
        type: &#x27;videoSeek&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    var ele = Dom.byId(value);
                    return (ele !== null) &amp;&amp; (ele.tagName.toLowerCase() === &#x27;video&#x27;);
                }
            },
            percentage: {
                name: &#x27;percentage&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    var percen = parseInt(value, 10);
                    return Lang.isNumber(percen);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_SEEK, {
                videoId: args.videoId,
                percentage: parseInt(args.percentage, 10)
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;videoStop&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_STOP, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;videoPause&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_PAUSE, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;videoSoundOn&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_SOUNDON, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;videoSoundOff&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_SOUNDOFF, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }, {
        type: &#x27;videoFullScreen&#x27;,
        argument: {
            videoId: {
                name: &#x27;videoId&#x27;,
                test: /* istanbul ignore next */ function (value) {
                    return Lang.isString(value);
                }
            },
            timeout: {
              name: &#x27;timeout&#x27;,
              test: function (value) {
                return Lang.isNumber(value) || value === undefined || value === null;
              }
            }
        },
        process: function (actionId, args) {
            Event.fire(EVENT_VIDEO_FULLSCREEN, {
                videoId: args.videoId
            });
            Event.fire(EVENT_GLOBAL_ACTION_COMPLETE, actionId);
        }
    }];

    /**
     * @class ContentVideoHtml
     * @constructor
     */
    function ContentVideoHtml(config) {
        this.init(config);
    }

    ContentVideoHtml.ATTRS = {

        /**
         * @attribute NAME
         * @type String
         */
        NAME: &#x27;ContentVideoHtml&#x27;,

        /**
         * @attribute videoConfig
         */
        videoConfig: {},

        /**
         * @attribute configObject
         * @type Object
         */
        configObject: {},

        /**
         * @attribute videoPath
         */
        videoPath: {},

        /**
         * @attribute node
         * @type HTMLElement
         */
        node: null,

        /**
         * @attribute videoId
         * @type String
         */
        videoId: null,

        /**
         * Reference for Video Events
         * @attribute videoEventsRef
         * @type Object
         */
        videoEventsRef: null,

        /**
         * List custom EventType for video such as cuePoint.
         * @attribute customEventActions
         */
        customEventActions: {}

    };

    /* Private methods */

    /* ------------------- FUNCTIONS FOR RENDERING VIDEO NODE OBJECT - BEGIN ------------------------------------*/

    /**
     * Subscribe custom execution to the video event
     *
     * @method subscribeToVideoEvent
     * @private
     * @param {String} node Node to attach event
     * @param {Object} actionConfig Config for actions to be fired
     */

    function subscribeToVideoEvent(node, actionConfig) {
        // listent to video state event
        // using node id to check if this state is for this node
        // checking eventType of actionConfig to see if its the trigger event
        /* Store the event subscription into a variable and return it at the end of the function. */
        var subscribedEvent = Event.on(EVENT_VIDEO_STATE, function (eventData) {
            /*@&lt;*/
            Debug.log(&#x27;[ ACT_contentVideoHtml.js ] on &#x27;, EVENT_VIDEO_STATE, eventData);
            /*&gt;@*/

            if (eventData.videoId === node.id &amp;&amp; eventData.data === actionConfig.eventType) {
                Event.fire(EVENT_GLOBAL_CHECK_ACTION_CONDITION, {
                    actionConfig: actionConfig,
                    callback: function (isExecutable) {
                        if (isExecutable) {
                            /*@&lt;*/
                            Debug.warn(&#x27;[ ACT_contentVideoHtml.js ] executing : &#x27;, EVENT_GLOBAL_ACTION_ADD, actionConfig.actions);
                            /*&gt;@*/
                            Event.fire(EVENT_GLOBAL_ACTION_ADD, actionConfig.actions);
                        } /*@&lt;*/ else {
                            Debug.warn(&#x27;[ ACT_contentVideoHtml.js ] Actions is not executable!&#x27;, actionConfig);
                        }
                        /*&gt;@*/
                    }
                });
            }
        });

        /*@&lt;*/
        Debug.log(&#x27;[ ACT_contentVideoHtml.js ] Attaching video event &#x27; + actionConfig);
        /*&gt;@*/
        return subscribedEvent;
    }

    /**
     * Attach action for an event
     *
     * @method attachVideoEventActions
     * @private
     * @param {String} node, node to attach events
     * @param {String} eventConfig, list of event
     * @param {Object} customEventActions List of custom video events allowd by the contentVideoInstance
     */
    function attachVideoEventActions(node, eventConfig, customEventActions) {
        var eventsList = [];
        var index;
        var actionConfig;
        if (!Lang.isArray(eventConfig)) {
            /*@&lt;*/
            Debug.log(&#x27;[ ACT_contentVideoHtml.js ] eventConfig is empty:&#x27;, eventConfig);
            /*&gt;@*/
            return eventsList;
        }

        // at least customEventActions must be empty object to avoid broken code
        customEventActions = customEventActions || {};

        // go throught all event config
        // if eventType is on the action list then subcribe actions on this eventType
        for (index = 0; index &lt; eventConfig.length; index++) {
            actionConfig = eventConfig[index];
            /* istanbul ignore next */
            if (DEFAULT_VIDEO_EVENT_ACTIONS.hasOwnProperty(actionConfig.eventType) || customEventActions.hasOwnProperty(actionConfig.eventType)) {
                eventsList.push(subscribeToVideoEvent(node, actionConfig));
            }
        }
        /*@&lt;*/
        Debug.log(&#x27;[ ACT_contentVideoHtml.js ] subscribed to : &#x27;, eventsList);
        /*&gt;@*/
        return eventsList;
    }

    /**
     * Function to applying video configuration to video node (e.g: autoplay, muted)
     *
     * @method applyVideoState
     * @param node
     * @param videoConfig
     * @return {*}
     * @private
     */
    function applyVideoState(node, videoConfig) {
        // showing native control
        node.controls = (videoConfig.controls !== false);
        // set auto play
        node.autoplay = (videoConfig.autoplay === true);
        // set sound option
        node.muted = (videoConfig.videoMuted === true);
        // set loop option
        node.loop = (videoConfig.loop === true);
        // set poster image
        if (typeof videoConfig.posterImage === &#x27;string&#x27;) {
            node.poster = videoConfig.posterImage;
        }

        return node;
    }

    /**
     * Return video source nodes
     * @param configVideo Video configuration
     * @return {string}
     * @private
     */
    function appendVideoSourcesToNode(configVideo) {
        var source = &#x27;&#x27;;
        var videoPath = configVideo.videoPath;
        var index;
        var src;
        var type;
        for (index = 0; index &lt; videoPath.length; index++) {
            src = videoPath[index].path;
            type = VIDEO_FORMAT[videoPath[index].type];
            source += &#x27;&lt;source src=&quot;&#x27; + src + &#x27;&quot; type=&quot;&#x27; + type + &#x27;&quot; &gt;&lt;/source&gt;&#x27;;
        }
        return source;
    }

    /**
     * Function generate list of available video path from given configVideo
     *
     * @method initializeVideoPath
     * @param {Object} configVideo
     * @return {Array} list of video path
     */
    function initializeVideoPath(configVideo) {
        var index;
        var type;
        var keyword;
        configVideo.videoPath = [];

        for (index = 0; index &lt; ACCEPTED_VIDEO_TYPE.length; index++) {
            type = ACCEPTED_VIDEO_TYPE[index];
            keyword = &#x27;video&#x27; + type;
            if (typeof configVideo[keyword] === &#x27;string&#x27;) {
                configVideo.videoPath.push({
                    type: type.toLowerCase(),
                    path: configVideo[keyword]
                });
            }
        }
    }

    /**
     * Set attributes to the node
     *
     * @method setAttributes
     * @private
     * @param {HTMLElement} node
     * @param {Object} attrs
     */
    function setAttributes(node, attrs) {
        var attr;
        for (attr in attrs) {
            /* istanbul ignore next */
            if (attrs.hasOwnProperty(attr)) {
                node.setAttribute(attr, attrs[attr]);
            }
        }
    }

    /* --------------------- FUNCTIONS FOR RENDERING VIDEO NODE OBJECT - END ----------------------------------*/

    /* Public methods */
    Lang.extend(ContentVideoHtml, [Capability, Class], {

        initializer: function (config) {
            // set videoId
            this.set(&#x27;videoId&#x27;, config.id);

            // save configObject reference
            this.set(&#x27;configObject&#x27;, config);

            // register action to actions-queue
            Event.fire(EVENT_GLOBAL_ACTION_REGISTER, videoEvents);

            // subscribes and save listeners
            this.initializeListeners();
        },

        /**
         * Function to initialize event listeners for this instance
         *
         * @method initializeListeners
         */
        initializeListeners: function () {
            var root = this;

            // create new event listener and push it inside event array
            root.addEventListeners(
                Event.on(EVENT_VIDEO_START, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.start();
                    }
                }),
                Event.on(EVENT_VIDEO_STOP, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.stop();
                    }
                }),
                Event.on(EVENT_VIDEO_PLAY, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.play();
                    }
                }),
                Event.on(EVENT_VIDEO_SEEK, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.seek(eventData.percentage);
                    }
                }),
                Event.on(EVENT_VIDEO_PAUSE, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.pause();
                    }
                }),
                Event.on(EVENT_VIDEO_SOUNDON, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.soundOn();
                    }
                }),
                Event.on(EVENT_VIDEO_SOUNDOFF, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.soundOff();
                    }
                }),
                Event.on(EVENT_VIDEO_FULLSCREEN, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.fullScreen();
                    }
                }),
                Event.on(EVENT_VIDEO_RESIZE, function (eventData) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;videoId&#x27;) === eventData.videoId) {
                        root.resize(eventData.state);
                    }
                }),
                Event.on(EVENT_GLOBAL_SCREEN_STATUS, function (status) {
                    /* istanbul ignore else */
                    if (root.get(&#x27;configObject&#x27;) &amp;&amp; root.get(&#x27;configObject&#x27;).resize) {
                        root.resize(status, root.get(&#x27;configObject&#x27;));
                    }
                })
           );
        },

        /**
         * Function to be called when the instance is destroyed
         *
         * @method destructor
         */
        destructor: function () {
            var node = this.get(&#x27;node&#x27;);
            var videoEv = this.get(&#x27;videoEventsRef&#x27;);

            // remove video action &amp; events
            if (Lang.isFunction(videoEv.destroy)) {
                videoEv.destroy();
            }

            /* Remove the node from the DOM */
            if (node &amp;&amp; node.parentNode) {
                node.parentNode.removeChild(node);
            }
        },

        /**
         * Render the node from given config object, environment and orientation state
         *
         * @method renderContent
         * @param {Object} configObject
         * @param {String} env
         * @param {String} orientation
         * @return {HTMLElement} node
         */
        renderContent: function (configObject) {
            var node;
            var video;
            var source;
            var meta;
            var eventsAdded;

            // initialize video path
            initializeVideoPath(configObject.videoHtmlConfig);

            // create video tag
            // review this
            meta = &#x27;&lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=Edge&quot;/&gt;&#x27;;
            source = appendVideoSourcesToNode(configObject.videoHtmlConfig);
            video = &#x27;&lt;video preload=&quot;auto&quot; autoplay&gt;&#x27; + meta + source + &#x27;&lt;/video&gt;&#x27;;

            node = Dom.nodeCreate(video).firstChild;

            // set tag attributes
            setAttributes(node, {
                id: configObject.id
            });

            // applying initial state for the video
            applyVideoState(node, configObject.videoHtmlConfig);

            // attach video event to actions
            eventsAdded = attachVideoEventActions(node, configObject.eventConfig, configObject.customEventActions);

            node = this.applyNodeConfig(node, configObject);

            /*@&lt;*/
            /* Error listening, so we can log it in debug version. */
            Event.on(&#x27;error&#x27;, function (e) { Debug.log(&#x27;[ ACT_contentVideoHtml.js ] Error in video:&#x27;, e, node.error.code); }, node, this);
            Debug.log(&#x27;[ ACT_contentVideoHtml.js ] Generated node/events:&#x27;, node, eventsAdded, eventsAdded.length);
            /*&gt;@*/

            /* We are now returning a more complex object from this function so that we can push over the newly added events. */
            return {
                node: node,
                events: eventsAdded
            };
        },

        /**
         * @method getContent
         * @param {String} env Environment for rendering content such as html/flash/backup
         * @param {String} orientation Orientation of current device such as landscape and portraits for mobile
         * @return {HTMLElement} node
         */
        getContent: function (env, orientation) {
            var renderedNode = this.renderContent(this.get(&#x27;configObject&#x27;), env, orientation);
            var node = renderedNode.node;
            var index;

            /* all listeners must have a references in eventList array so we can detach them when need */
            for (index = 0; index &lt; renderedNode.events.length; index++) {
                this.addEventListeners(renderedNode.events[index]);
            }

            // create video events
            this.createVideoEvents(node);
            // save reference to the node
            this.set(&#x27;node&#x27;, node);

            /*@&lt;*/
            Debug.log(&#x27;[ ACT_contentVideoHtml.js ] getContent node and events are: &#x27;, node, this.get(&#x27;eventList&#x27;).length);
            /*&gt;@*/

            return {
                node: node
            };
        },

        /**
         * Function to send notification to other part of the system about changes of the video instance
         * @param videoID
         * @param progress
         */
        broadcastProgress: function (videoID, progress) {
            Event.fire(EVENT_VIDEO_STATE, {
                videoId: videoID,
                data: progress
            });
        },

        /**
         * Create video events for node
         * @param node
         */
        createVideoEvents: function (node) {
            var root = this;
            var videoID = this.get(&#x27;videoId&#x27;);
            var config = this.get(&#x27;configObject&#x27;);
            var videoConfig = config.videoHtmlConfig;
            var clicked = videoConfig.clicked || false;
            var localVideoEvents;
            var eventsConfig = {
                tracking: {
                    start: true,
                    25: true,
                    50: true,
                    75: true,
                    ended: true,
                    pause: true,
                    volumechange: true,
                    seeked: false,
                    clicked: clicked
                },
                cuePoints: {}
            };

            /*
            Passing customEvents into VideoEvents as cuePoints so it can be fired at exact time
            Also need to add custom event name into tracking so it can be listened
            e.g:
            If we have customEventActions[&#x27;customEventName&#x27;] = 4 // trigger customEventName at the second 4th
            VideoEvent config will have:
                eventsConfig.tracking.customEventName = true;
            and
                eventsConfig.cuePoints[4] = &#x27;customEventName&#x27;;
            */
            var customEventActions = this.get(&#x27;customEventActions&#x27;);
            Lang.forEach(customEventActions, function (index, value) {
                eventsConfig.cuePoints[value] = index;
                eventsConfig.tracking[index] = true;
            });

            localVideoEvents = new ACT.VideoEvents(node, videoID, eventsConfig);
            this.set(&#x27;videoEventsRef&#x27;, localVideoEvents);

            root.addEventListeners(
                Event.on(EVENT_VIDEO_ACTION, function (data) {
                    root.onVideoEvents(videoID, data, root.broadcastProgress);
                })
           );
        },

        /**
         * Video Events listener
         * @param videoID
         * @param data
         * @param callback
         */
        onVideoEvents: function (videoID, data, callback) {
            var event;
            if (data.hasOwnProperty(&#x27;videoId&#x27;) &amp;&amp; data.videoId === videoID &amp;&amp; data.hasOwnProperty(&#x27;eventLongName&#x27;)) {
                event = data.eventLongName;
                if (Lang.isFunction(callback)) {
                    callback(videoID, event);
                }
            }
        },

        /* ----------------------FUNCTIONS FOR VIDEO ACTIONS - BEGIN---------------------------------*/

        /**
         * Play video from the very beginning
         * @method start
         */
        start: function () {
            this.play(0);
        },

        /**
         * Play video from start time position
         * If startTime is not set then the video will play from current position
         * @param startTime
         */
        play: function (startTime) {
            var node = this.get(&#x27;node&#x27;);
            if (Lang.isStrictNumber(startTime)) {
                node.currentTime = startTime;
            }
            node.play();
        },

        /**
         * Seeking video to a particular percentage
         *
         * @method seek
         * @param {Number} percentage
         */
        seek: function (percentage) {
            var node;
            var time;
            if (percentage &lt; 0 || percentage &gt; 100) {
                return;
            }
            node = this.get(&#x27;node&#x27;);
            time = (percentage * node.duration) / 100;
            node.currentTime = time;
        },

        /**
         * Stop the video and set current position to the beginning
         * @method stop
         */
        stop: function () {
            // pause the video then set the currentTime of video to 0
            this.pause(0);
        },

        /**
         * Pause the video at current positions.
         * If new time is set, then the current time of the video will be set to new time value
         *
         * @method pause
         * @param {Integer} [newTime]
         */
        pause: function (newTime) {
            var node = this.get(&#x27;node&#x27;);
            if (Lang.isStrictNumber(newTime)) {
                node.currentTime = newTime;
            }
            node.pause();
        },

        /**
         * Turn on the sound of the video
         * @method soundOn
         */
        soundOn: function () {
            var node = this.get(&#x27;node&#x27;);
            node.muted = false;
        },

        /**
         * Turn off the sound of the video
         * @method soundOff
         */
        soundOff: function () {
            var node = this.get(&#x27;node&#x27;);
            node.muted = true;
        },

        /**
         * Request Full Screen
         * @method fullScreen
         */
        fullScreen: function () {
            var node = this.get(&#x27;node&#x27;);
            var isFunction = Lang.isFunction;
            if (isFunction(node.requestFullscreen)) {
                node.requestFullscreen();
            } else if (isFunction(node.msRequestFullscreen)) {
                node.msRequestFullscreen();
            } else if (isFunction(node.mozRequestFullScreen)) {
                node.mozRequestFullScreen();
            } else if (isFunction(node.webkitRequestFullscreen)) {
                node.webkitRequestFullscreen();
            } else {
                // cannot fullscreen
            }
        }

        /* ---------------------FUNCTIONS FOR VIDEO ACTIONS - END----------------------------------*/

    });

    return ContentVideoHtml;
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
