<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>src/core/ACT_base.js - ACT.js</title>
    <link rel="stylesheet" href="https://s.yimg.com/zz/combo?yui-s:3.14.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="https://s.yimg.com/rz/l/favicon.ico">
    <script src="https://s.yimg.com/zz/combo?yui-s:3.14.1/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="https://s.yimg.com/cv/ae/global/ACTJS/logo/ACT.js.logo.png" title="ACT.js" width="150"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 1.1.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                            <li><a href="#api-demos">Demo and Examples</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/ACT.html">ACT</a></li>
                                <li><a href="../classes/ActionsQueue.html">ActionsQueue</a></li>
                                <li><a href="../classes/Base.html">Base</a></li>
                                <li><a href="../classes/Capability.html">Capability</a></li>
                                <li><a href="../classes/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../classes/Class.html">Class</a></li>
                                <li><a href="../classes/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../classes/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../classes/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../classes/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../classes/ContentImage.html">ContentImage</a></li>
                                <li><a href="../classes/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../classes/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../classes/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../classes/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../classes/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../classes/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../classes/Cookie.html">Cookie</a></li>
                                <li><a href="../classes/CustomData.html">CustomData</a></li>
                                <li><a href="../classes/Debug.html">Debug</a></li>
                                <li><a href="../classes/Dom.html">Dom</a></li>
                                <li><a href="../classes/DwellTime.html">DwellTime</a></li>
                                <li><a href="../classes/Enabler.html">Enabler</a></li>
                                <li><a href="../classes/Environment.html">Environment</a></li>
                                <li><a href="../classes/Event.html">Event</a></li>
                                <li><a href="../classes/Flash.html">Flash</a></li>
                                <li><a href="../classes/IO.html">IO</a></li>
                                <li><a href="../classes/Json.html">Json</a></li>
                                <li><a href="../classes/Lang.html">Lang</a></li>
                                <li><a href="../classes/LayersList.html">LayersList</a></li>
                                <li><a href="../classes/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../classes/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../classes/Screen.html">Screen</a></li>
                                <li><a href="../classes/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../classes/StandardAd.html">StandardAd</a></li>
                                <li><a href="../classes/Tracking.html">Tracking</a></li>
                                <li><a href="../classes/UA.html">UA</a></li>
                                <li><a href="../classes/Util.html">Util</a></li>
                                <li><a href="../classes/VideoEvents.html">VideoEvents</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/ACT.html">ACT</a></li>
                                <li><a href="../modules/actionsQueue.html">actionsQueue</a></li>
                                <li><a href="../modules/Base.html">Base</a></li>
                                <li><a href="../modules/CapabilitySkeleton.html">CapabilitySkeleton</a></li>
                                <li><a href="../modules/ContentAdobeEdge.html">ContentAdobeEdge</a></li>
                                <li><a href="../modules/ContentCarousel.html">ContentCarousel</a></li>
                                <li><a href="../modules/ContentContainer.html">ContentContainer</a></li>
                                <li><a href="../modules/ContentHtml5.html">ContentHtml5</a></li>
                                <li><a href="../modules/ContentImage.html">ContentImage</a></li>
                                <li><a href="../modules/ContentProgressBar.html">ContentProgressBar</a></li>
                                <li><a href="../modules/ContentSwf.html">ContentSwf</a></li>
                                <li><a href="../modules/ContentThirdParty.html">ContentThirdParty</a></li>
                                <li><a href="../modules/ContentVideoFlash.html">ContentVideoFlash</a></li>
                                <li><a href="../modules/ContentVideoHtml.html">ContentVideoHtml</a></li>
                                <li><a href="../modules/ContentYoutube.html">ContentYoutube</a></li>
                                <li><a href="../modules/Cookie.html">Cookie</a></li>
                                <li><a href="../modules/DwellTime.html">DwellTime</a></li>
                                <li><a href="../modules/Enabler.html">Enabler</a></li>
                                <li><a href="../modules/environment.html">environment</a></li>
                                <li><a href="../modules/IO.html">IO</a></li>
                                <li><a href="../modules/LayersList.html">LayersList</a></li>
                                <li><a href="../modules/LayerStandard.html">LayerStandard</a></li>
                                <li><a href="../modules/Scaffolding.html">Scaffolding</a></li>
                                <li><a href="../modules/Screen.html">Screen</a></li>
                                <li><a href="../modules/SecureDarla.html">SecureDarla</a></li>
                                <li><a href="../modules/StandardAd.html">StandardAd</a></li>
                                <li><a href="../modules/Tracking.html">Tracking</a></li>
                            </ul>
                
                            <ul id="api-demos" class="apis demos">
                                <li><a href="../demo/ACT_Demo_300x250.html">300x250</a></li>
                                <li><a href="../demo/ACT_Demo_300x250_tracking.html">300x250_tracking</a></li>
                                <li><a href="../demo/ACT_Demo_TrackingExample.html">TrackingExample</a></li>
                                <li><a href="../demo/ACT_Demo_animation.html">animation</a></li>
                                <li><a href="../demo/ACT_Demo_billboard.html">billboard</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-enabler.html">billboard-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard-expandable-enabler.html">billboard-expandable-enabler</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video.html">billboard_html_video</a></li>
                                <li><a href="../demo/ACT_Demo_billboard_html_video_rtl.html">billboard_html_video_rtl</a></li>
                                <li><a href="../demo/ACT_Demo_carousel.html">carousel</a></li>
                                <li><a href="../demo/ACT_Demo_dwelltime.html">dwelltime</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_expand.html">enabler_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_fullscreen_expand.html">enabler_fullscreen_expand</a></li>
                                <li><a href="../demo/ACT_Demo_enabler_target.html">enabler_target</a></li>
                                <li><a href="../demo/ACT_Demo_floating.html">floating</a></li>
                                <li><a href="../demo/ACT_Demo_force_env.html">force_env</a></li>
                                <li><a href="../demo/ACT_Demo_html5_enabler.html">html5_enabler</a></li>
                                <li><a href="../demo/ACT_Demo_html5_standard.html">html5_standard</a></li>
                                <li><a href="../demo/ACT_Demo_icons.html">icons</a></li>
                                <li><a href="../demo/ACT_Demo_input_data.html">input_data</a></li>
                                <li><a href="../demo/ACT_Demo_login_html.html">login_html</a></li>
                                <li><a href="../demo/ACT_Demo_overwrite_env.html">overwrite_env</a></li>
                                <li><a href="../demo/ACT_Demo_splash_ad.html">splash_ad</a></li>
                                <li><a href="../demo/ACT_Demo_tablet_expandable.html">tablet_expandable</a></li>
                                <li><a href="../demo/ACT_Demo_video_event.html">video_event</a></li>
                                <li><a href="../demo/ACT_Demo_video_html.html">video_html</a></li>
                            </ul>
                
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: src/core/ACT_base.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * Copyright 2016, Yahoo Inc.
 * Copyrights licensed under the New BSD License.
 * See the accompanying LICENSE file for terms.
 */

/* global ACT */
ACT.define(&#x27;Base&#x27;, [/*@&lt;*/&#x27;Debug&#x27;, /*&gt;@*/ &#x27;Event&#x27;, &#x27;Cookie&#x27;, &#x27;Lang&#x27;, &#x27;Tracking&#x27;, &#x27;SecureDarla&#x27;, &#x27;StandardAd&#x27;, &#x27;ActionsQueue&#x27;, &#x27;CustomData&#x27;, &#x27;IO&#x27;, &#x27;Environment&#x27;, &#x27;UA&#x27;, &#x27;Util&#x27;], function (ACT) {
    &#x27;use strict&#x27;;

    var Lang = ACT.Lang;
    var Event = ACT.Event;
    var Cookie = ACT.Cookie;
    var Tracking = ACT.Tracking;
    var SecureDarla = ACT.SecureDarla;
    var CustomData = ACT.CustomData;
    var ActionsQueue = ACT.ActionsQueue;
    var UA = ACT.UA;
    var IO = ACT.IO;
    var Util = ACT.Util;

    /*@&lt;*/
    var debug = ACT.Debug;
    /*&gt;@*/

    /**
    * Base - starts up the basic ad framework
    *
    *     var conf = {
    *         conf: {
    *             tracking: {
    *                 id: &#x27;&#x27;
    *             },
    *             template: {
    *                 name: &#x27;name_of_ad&#x27;,
    *                 type: &#x27;type_of_ad&#x27;,
    *                 format: &#x27;format_of_ad&#x27;,
    *                 width: 300,
    *                 height: 250
    *             },
    *             inputData:{
    *                type:&#x27;JSON&#x27;,
    *                id: &#x27;myYT&#x27;,
    *                dataFeed: &#x27;json_feed.js&#x27;
    *            },
    *            customData:{
    *                 &quot;layers.mpu.width&quot; : &#x27;500px&#x27;
    *             }
    *         },
    *         superConf: &#x27;mazda-ad-20150401&#x27;,
    *         extend:{
    *             init: function () { ... },
    *             ad_init: function () { ... },
    *             happy: function () { ... }
    *         }
    *     }
    *
    * @class Base
    * @module Base
    * @requires event, cookie, lang, tracking, securedarla, standardad, actionsqueue
    * @param config {Object} -
    *   conf: Basic configuration overwrites/definitions ( tracking, cookie, etc )
    *   superConf: A name of the super conf that we need to load in
    *   inputData: Inject dynamic data and use it in shortcuts to override configuration object.
    *   customData: Shortcuts to overwrite super configuration attributes
    *   extend : Set of functions to execute - init, ad_init etc.
    *
    */
    function Base(config) {
        var conf = config.conf || {};
        var extend = config.extend || {};
        var root = this;
        // super conf is a string name of the super config we need to check against.
        var superConf = config.superConf || null;
        /*@&lt;*/
        debug.log(&#x27;[ ACT_base.js ]: instantiated with config&#x27;, config);
        /*&gt;@*/

        Lang.merge(this, extend);
        Lang.merge(this.config, conf);

        /* Store reference for future use and loading */
        this.config.superConf = superConf;

        if (superConf !== null) {
            ACT.requireConfig(config.superConf);
            this.config.standardAd = true;
        } else {
            this.config.standardAd = false;
        }

        ACT.ready(function () {
            root.start();
        });
    }

    /**
    * @attribute ATTRS
    * @type {{NAME: string, version: string}}
    * @initOnly
    */
    Base.ATTRS = {
        NAME: &#x27;Base&#x27;,
        version: &#x27;1.1.0&#x27;
    };

    Base.prototype = {

        /**
        * Basic Config - will be removed here and config will be defined as empty obj.
        * @property config
        * @type Object
        */
        config: { },

        /**
        * Start up the Standard Ad if the superConf is supplied.
        * @method register
        * @private
        * @static
        */
        register: function () {
            var conf = this.config;
            var root = this;
            var comingData;
            var IOLoad;
            var superConfMerged;

            if (this.config.standardAd === true) {
                // if the custom Data
                if (conf.customData &amp;&amp; !Lang.isObjectEmpty(conf.customData)) {
                    // if there any comming input
                    if (conf.inputData) {
                        /*@&lt;*/
                        debug.log(&#x27;[ ACT_base.js ] comingData&#x27;, comingData);
                        /*&gt;@*/
                        // loaded event
                        IOLoad = Event.on(&#x27;IO:load:done&#x27;, function (data) {
                            var customDataWithComing;
                            var onEventSuperConfMerged;
                            IOLoad.remove();
                            /* istanbul ignore else */
                            if (conf.inputData.type === &#x27;JSON&#x27;) {
                                customDataWithComing = CustomData.inputOntoCustomDataJSON(conf.inputData.id, conf.customData, data.response);
                            }
                            onEventSuperConfMerged = CustomData.map(customDataWithComing, ACT.getConfig(conf.superConf));
                            root.config = Lang.merge(conf, onEventSuperConfMerged);
                            root.loadStandardAd();
                        });
                        // load input
                        comingData = new IO(conf.inputData);
                    } else {
                        superConfMerged = CustomData.map(conf.customData, ACT.getConfig(conf.superConf));
                        root.config = Lang.merge(conf, superConfMerged);
                        root.loadStandardAd();
                    }
                } else {
                    root.config = Lang.merge(conf, ACT.getConfig(conf.superConf));
                    root.loadStandardAd();
                }
            } else {
                /* We can pull provided pixels here. */
                root.trackPixel(conf.pixels);
            }
        },

        /**
        * A wrapper for StandardAd initialization. This is here to optimize the &#x27;register&#x27; function.
        * @method loadStandardAd
        * @private
        * @static
        */
        loadStandardAd: function () {
            var root = this;
            var standard;
            var config = root.config;
            var forceEnv = {};
            var ev;
            /*@&lt;*/
            debug.log(&#x27;[ ACT_base.js ] Loading Standard Ad with the following Config Object : &#x27;, root.config);
            /*&gt;@*/
            standard = new ACT.StandardAd({ config: config, parent: root });
            root.config.standardAdRef = standard;

            /* Technically &#x27;forceEnv&#x27; is always defined, because Environment requires it to be and errors without it. */
            /* istanbul ignore else */
            if (config.hasOwnProperty(&#x27;baseConfig&#x27;) &amp;&amp; config.baseConfig.hasOwnProperty(&#x27;forceEnv&#x27;)) {
                forceEnv = config.baseConfig.forceEnv;
            }

            ev = new ACT.Environment({
                forceEnv: forceEnv
            });

            this.currentEnv = ev.checkEnv();
            this.trackPixel(config.pixels);
        },

        /**
        * Starts up the ad, instantiating all the necessary key players for an ad to work
        * @method start
        * @public
        * @static
        */
        start: function () {
            var conf = this.config;

            this.loadListeners();

            /* istanbul ignore next */
            this.actionsQueue = new ActionsQueue({});
            this.cookie = new Cookie(conf.cookie || null, this);
            this.tracking = new Tracking(conf.tracking || null, this);
            this.secureDarla = new SecureDarla(this.config, this);

            /*@&lt;*/
            debug.info(&#x27;[ ACT_base.js ] SecureDarla INITIALIZE PASSED - NOW START AD STANDARD&#x27;);
            /*&gt;@*/

            this.init();
        },

        /**
         * A function to fire pixels
         * @param pixels
         */
        trackPixel: function (pixels) {
            var env;
            var traverse = pixels;
            var itor;
            var len;
            if (this.hasOwnProperty(&#x27;currentEnv&#x27;)) {
                env = this.currentEnv;
            } else {
                /* istanbul ignore else */
                if (UA.isHtml5Supported === true) {
                    env = &#x27;html&#x27;;
                } else {
                    env = &#x27;backup&#x27;;
                }
            }

            /*@&lt;*/
            debug.info(&#x27;[ ACT_base.js ] Ready to fire pixels from env: &#x27;, env);
            /*&gt;@*/

            if (Lang.isObject(pixels)) {
                /* Traverse pixels */
                traverse = pixels.hasOwnProperty(env) ? pixels[env] : pixels;
            }

            if (Lang.isArray(traverse)) {
                for (itor = 0, len = traverse.length; itor &lt; len; itor++) {
                    /*@&lt;*/
                    debug.info(&#x27;[ ACT_base.js ]: Firing pixel : &#x27;, traverse[itor]);
                    /*&gt;@*/
                    Util.pixelTrack(traverse[itor]);
                }
            } /* istanbul ignore else */ else if (Lang.isString(traverse) &amp;&amp; traverse.length &gt; 3) {
                Util.pixelTrack(traverse);
            }
        },

        /**
        * A method that places the &#x27;ad_init&#x27; function &#x60;onload&#x60;
        * @method loadListeners
        * @public
        * @static
        */
        loadListeners: function () {
            /* Once &#x27;domready&#x27; event is fully available, see about moving these from load to domready. */
            this.adInitEvent = Event.on(&#x27;load&#x27;, this.ad_init, window, this);
            this.registerEvent = Event.on(&#x27;load&#x27;, this.register, window, this);
        },

        /**
         * An empty function to be overwritten via &#x27;extend&#x27;
         * @method init
         * @public
         */
        init: function () {
            /* overwritable */
        },

        /**
         * An empty function to be overwritten via &#x27;extend&#x27;
         * @method ad_init
         * @public
         */
        ad_init: function () {
            /* overwritable */
        }
    };

    function startupBase(config) {
        return new Base(config);
    }

    startupBase.ATTRS = Base.ATTRS;

    return startupBase;
});

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
